{% extends 'base.html' %}
{% block title %}Generate AI Notes · StudyAssistant{% endblock %}

{% block content %}
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');

  :root{
    --ink:#e7e7e7; --muted:#bfc6d0;
    --panel:rgba(255,255,255,.06); --border:rgba(255,255,255,.14);
    --accent:#ffeb3b; --accent-2:#ffd600;
  }

  body{
    background:
      radial-gradient(1200px 620px at 16% -12%, rgba(255,235,59,.12), transparent 50%),
      radial-gradient(1000px 680px at 115% 20%, rgba(255,235,59,.08), transparent 55%),
      linear-gradient(135deg,#111827,#0b1020 60%);
    margin:0; font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:var(--ink);
  }

  .page{
    min-height:calc(100vh - 65px);
    display:flex; align-items:flex-start; justify-content:center;
    padding:84px 16px 48px;
  }

  .card{
    width:100%; max-width:820px; position:relative;
    background:var(--panel); border:1px solid var(--border); border-radius:20px;
    box-shadow:0 15px 45px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.04);
    backdrop-filter:blur(14px); overflow:hidden; animation:pop .45s ease;
  }
  .card::before{
    content:""; position:absolute; inset:-60% -60% auto auto; width:220%; height:220%;
    background:conic-gradient(from 0deg, var(--accent), var(--accent-2), var(--accent));
    opacity:.05; animation:spin 12s linear infinite;
  }
  .card > *{position:relative; z-index:1}

  header{
    display:flex; align-items:center; justify-content:space-between; gap:12px;
    padding:18px 22px; border-bottom:1px solid var(--border);
  }
  .h-left{display:flex; align-items:center; gap:12px}
  .dot{width:10px; height:10px; border-radius:50%; background:var(--accent); box-shadow:0 0 10px var(--accent)}
  h2{margin:0; font-weight:800; letter-spacing:.3px; color:var(--accent); text-shadow:0 0 10px rgba(255,235,59,.45)}
  .subtle{color:var(--muted); font-size:12px}

  .body{padding:18px}

  /* Single panel */
  .panel{
    background:rgba(255,255,255,.05); border:1px solid var(--border);
    border-radius:16px; padding:16px;
  }
  .panel h3{
    margin:0 0 10px; color:var(--accent); font-size:15px; letter-spacing:.3px;
    text-shadow:0 0 6px rgba(255,235,59,.45)
  }

  /* Form controls (works with {{ form.as_p }}) */
  form p{margin:0 0 12px}
  form p label{
    display:block; margin:8px 0 6px; color:var(--accent); font-size:13px;
    text-shadow:0 0 6px rgba(255,235,59,.35)
  }
  input[type=text], input[type=number], input[type=file], select, textarea{
    width:100%; padding:12px 14px; font-size:13px; color:#fff;
    background:rgba(255,255,255,.10); border:1px solid rgba(255,255,255,.12);
    border-radius:12px; outline:none; box-shadow:inset 0 0 6px rgba(0,0,0,.25); transition:.2s ease;
  }
  input[type=file]{cursor:pointer}
  textarea{min-height:140px; resize:vertical}
  input:focus, select:focus, textarea:focus{
    background:rgba(255,255,255,.16); box-shadow:0 0 12px rgba(255,235,59,.45), inset 0 0 6px rgba(0,0,0,.25);
    transform:translateY(-1px)
  }
  select{
    appearance:none; -webkit-appearance:none; -moz-appearance:none;
    background-image:linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.08));
  }
  select option{background:#1f1f1f; color:#fff}
  select option:checked{background:#3a3a3a; color:var(--accent); font-weight:700}

  .note{
    background:rgba(255,235,59,.12); border:1px solid rgba(255,235,59,.45);
    color:var(--accent); padding:10px; border-radius:12px; font-size:12px; margin-top:8px;
  }

  .btns{display:flex; gap:10px; align-items:center; margin-top:12px}
  .btn{
    padding:12px 16px; border:none; border-radius:12px; font-weight:900; cursor:pointer; transition:.18s ease;
  }
  .btn-primary{
    background:linear-gradient(180deg,var(--accent-2),var(--accent)); color:#1b1b1b;
    border:1px solid rgba(0,0,0,.15); box-shadow:0 10px 22px rgba(255,235,59,.35)
  }
  .btn-primary:hover{transform:translateY(-1px) scale(1.01)}
  .btn-ghost{background:transparent; color:#fff; border:1px dashed rgba(255,255,255,.35)}
  .btn-ghost:hover{border-color:#fff; transform:translateY(-1px)}

  .loading{display:flex; align-items:center; gap:10px; margin-top:8px; color:#eee; font-size:13px; visibility:hidden}
  .spinner{
    width:18px; height:18px; border-radius:50%;
    border:3px solid rgba(255,255,255,.3); border-top-color:var(--accent);
    animation:spin 1s linear infinite;
  }

  @keyframes pop{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
  @keyframes spin{to{transform:rotate(360deg)}}
</style>

<div class="page">
  <div class="card">
    <header>
      <div class="h-left">
        <span class="dot"></span>
        <h2>Generate AI Notes</h2>
      </div>
      <div class="subtle">Upload notes — get clean, study-ready output.</div>
    </header>

    <div class="body">
      <form method="POST" action="{% url 'generated_notes' %}" enctype="multipart/form-data" onsubmit="return startLoading()">
        {% csrf_token %}

        <!-- Only ONE panel now -->
        <section class="panel">
          <h3>Details</h3>
          {{ form.as_p }}

          <div class="note">⚠️ Avoid handwritten scans. For long PDFs, split chapters (≤ 15 pages recommended).</div>

          <div class="btns">
            <button type="submit" class="btn btn-primary" id="submitBtn">Generate Notes</button>
            <button type="reset" class="btn btn-ghost" id="resetBtn">Reset</button>
          </div>

          <div class="loading" id="loadingRow">
            <div class="spinner" aria-hidden="true"></div>
            <div id="loadingMsg">Generating notes… this may take a few seconds ⏳</div>
          </div>
        </section>
      </form>
    </div>
  </div>
</div>

<script>
  const submitBtn = document.getElementById('submitBtn');
  const resetBtn = document.getElementById('resetBtn');
  const loadingRow = document.getElementById('loadingRow');

  function startLoading(){
    submitBtn.disabled = true;
    submitBtn.textContent = 'Generating…';
    if (loadingRow) loadingRow.style.visibility = 'visible';
    return true;
  }

  if (resetBtn){
    resetBtn.addEventListener('click', () => {
      submitBtn.disabled = false;
      submitBtn.textContent = 'Generate Notes';
      if (loadingRow) loadingRow.style.visibility = 'hidden';
    });
  }
</script>
{% endblock %}















